#!/usr/bin/env ruby

current_ruby_version = `ruby -v`[/(?!\s)\d.\d.\d/]
puts "What Ruby version? (Default: #{current_ruby_version})"

input = gets.chomp
ruby_version = ((input == '' ? nil : input) || current_ruby_version)

puts "What is the RVM gemset name?"

while gemset_name = gets.chomp
  case gemset_name
  when ''
    puts 'A gemset name is required (or \'q\' to quit)'
  when 'q'
    puts 'Quitting...'
    exit
  else
    puts "Using #{gemset_name}"
    break
  end
end

all_gemsets = `rvm gemset list`
if all_gemsets.include? gemset_name
  `rvm gemset use #{gemset_name}`
else
  `rvm gemset use #{gemset_name} --create`
end
`printf "#ruby=ruby-$ruby_version\n#ruby-gemset=$gemset_name\n\nsource 'https://rubygems.org'\n\n" > Gemfile`
